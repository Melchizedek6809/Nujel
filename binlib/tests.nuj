; Nujel - Copyright (C) 2020-2021 - Benjamin Vincent Schulenburg
; This project uses the MIT license, a copy should be included under /LICENSE

[when [and [!= ARCH "wasm"] popen]
          [test/add '[0 . ""] [repl/run-forked 1]]
          [test/add '[123 . ""] [repl/run-forked [exit 123]]]
          [test/add '[0 . "123"] [repl/run-forked [display 123]]]
          [test/add #t [file/dir? "stdlib"]]
          [test/add #f [file/file? "stdlib"]]
          [test/add #t [file/file? "GNUmakefile"]]
          [test/add #f [file/dir? "GNUmakefile"]]
          [test/add #f [[file/stat "GNUmakefile"] :error?]]
          [test/add #t [[file/stat "This-file-should-never-exist.jpeg"] :error?]]
          [test/add #t [> [[file/stat "GNUmakefile"] :size] 1024]]
          [test/add #t [int? [[file/stat "GNUmakefile"] :modification-time]]]
          [test/add #t [int? [[file/stat "GNUmakefile"] :access-time]]]
          [test/add #t [int? [[file/stat "GNUmakefile"] :mode]]]
          [test/add #t [bool? [[file/stat "GNUmakefile"] :regular-file?]]]
          [test/add #t [bool? [[file/stat "GNUmakefile"] :directory?]]]
          [test/add #t [bool? [[file/stat "GNUmakefile"] :character-device?]]]
          [test/add #t [bool? [[file/stat "GNUmakefile"] :block-device?]]]
          [test/add #t [bool? [[file/stat "GNUmakefile"] :named-pipe?]]]
]

[test/add #t [tree? environment/variables]]
[test/add #t [string? [tree/get environment/variables 'PATH]]]
